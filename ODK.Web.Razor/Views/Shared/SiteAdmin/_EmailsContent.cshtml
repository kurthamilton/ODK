@using ODK.Services.Settings
@using ODK.Web.Common.Services
@using ODK.Web.Razor.Models
@using ODK.Web.Razor.Models.SiteAdmin
@using ODK.Web.Razor.Services
@inject IRequestStore RequestStore
@inject ISettingsService SettingsService
@{
    var request = RequestStore.MemberChapterServiceRequest;
    var settings = await SettingsService.GetSiteEmailSettings(request);
}

<section class="section--admin">
    <h2>Settings</h2>
    <form action="/siteadmin/emails/settings" method="post">
        @*@Html.AntiForgeryToken()*@
        @await Html.PartialAsync("SiteAdmin/_EmailSettingsForm", new SiteEmailSettingsViewModel
        {
            ContactEmailAddress = settings.ContactEmailAddress,
            FromEmailAddress = settings.FromEmailAddress,
            FromEmailName = settings.FromName,
            PlatformTitle = settings.PlatformTitle,
            Title = settings.Title
        })
        <button class="btn btn-primary" type="submit">Update</button>
    </form>
</section>

<section class="section--admin">
    <h2>Emails</h2>
    @await Html.PartialAsync("SiteAdmin/_EmailsTable")
</section>
