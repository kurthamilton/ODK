@using ODK.Services.Features
@using ODK.Web.Common.Services
@using ODK.Web.Razor.Models.Components
@using ODK.Web.Razor.Pages.Chapters
@using ODK.Web.Razor.Services
@model FeatureTooltipViewModel
@inject IFeatureService FeatureService
@inject IRequestStore RequestStore
@{
    var platform = RequestStore.Platform;
    var feature = await FeatureService.GetUnseeen(RequestStore.MemberServiceRequest, Model.Name);
    if (feature == null)
    {
        return;
    }    

    var chapter = RequestStore.ChapterOrDefault;
    var description = feature.Description
        .Replace("{chapter.name}", chapter?.GetDisplayName(platform) ?? string.Empty);
}

<div class="ms-1 d-inline"
   data-bs-toggle="popover" 
   data-bs-container="body"
   data-bs-html="true"
   data-bs-trigger="manual"
   data-bs-title="New feature"
   data-popover-sanitize="false"
   data-popover-show
   data-feature-tip="@Model.Name">
    <div class="d-none" data-popover-content>        
        <div>@Html.Raw(description)</div>
        <div class="d-flex justify-content-end">
            <button class="btn btn-link btn-sm" data-feature-hidetip="@Model.Name" type="button">
                Close
            </button>
        </div>
    </div>
</div>