@page "/siteadmin/payments/{id:guid}"
@using ODK.Services.Settings
@using ODK.Web.Common.Components
@using ODK.Web.Common.Extensions
@using ODK.Web.Razor.Models.Components
@using ODK.Web.Razor.Models.SiteAdmin
@model PaymentSettingsEditModel
@inject ISettingsService SettingsService
@{
    Layout = "_SiteAdminLayout";
    Model.Title = "Payments | SiteAdmin";

    var settings = await SettingsService.GetSitePaymentSettings(Model.MemberServiceRequest, Model.Id);
}

@await Html.PartialAsync("Components/_Breadcrumbs", new BreadcrumbsViewModel
{
    Breadcrumbs = new[]
    {
        new MenuItem { Link = "/siteadmin/payments", Text = "Payments" },
        new MenuItem { Text = settings.Name }
    }
})

<section class="section">
    <form action="/siteadmin/payments/@settings.Id" method="post">
        @Html.AntiForgeryToken()
        @await Html.PartialAsync("SiteAdmin/_PaymentSettingsForm", new SitePaymentSettingsFormViewModel
        {         
            Commission = 100 * settings.Commission,
            Enabled = settings.Enabled,
            Name = settings.Name,
            Provider = settings.Provider,
            PublicKey = settings.ApiPublicKey,
            SecretKey = settings.ApiSecretKey            
        })
        <button class="btn btn-primary">Update</button>
    </form>
</section>