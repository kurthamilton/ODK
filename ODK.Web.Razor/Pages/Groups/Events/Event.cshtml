@page "/groups/{slug}/events/{shortcode}"
@using ODK.Services.Events
@using ODK.Web.Common.Components
@using ODK.Web.Common.Routes
@using ODK.Web.Razor.Models.Groups
@using ODK.Web.Razor.Models.Payments
@model EventModel
@inject IEventViewModelService EventViewModelService
@{
    Layout = "_HomeLayout";

    var chapter = Model.Chapter;
    var viewModel = await EventViewModelService.GetEventPageViewModel(
        Model.ServiceRequest, Model.CurrentMemberIdOrDefault, chapter, Model.Shortcode);

    Model.Title = $"{viewModel.Event.GetDisplayName()} | {viewModel.Chapter.GetDisplayName(Model.Platform)}";
}

@await Html.PartialAsync("Groups/_GroupBodyWithSidebar", new GroupBodyWithSidebarViewModel
{
    Title = "",
    Content = await Html.PartialAsync("Events/_EventContent", viewModel),
    Group = viewModel,
    SidebarContent = await Html.PartialAsync("Events/_EventSidebar", viewModel),
    Breadcrumbs = new[]
    {
        viewModel.Event.HasPassed 
            ? new MenuItem 
            {
                Icon = IconType.ArrowLeft,
                Link = Model.OdkRoutes.Groups.PastEvents(Model.Chapter),
                Text = "back to past events" 
            }
            : new MenuItem 
            { 
                Icon = IconType.ArrowLeft,
                Link = Model.OdkRoutes.Groups.Events(Model.Chapter),
                Text = "Back to events" 
            }
    }
})