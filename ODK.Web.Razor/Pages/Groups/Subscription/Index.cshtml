@page "/groups/{slug}/subscription"
@using ODK.Services.Chapters
@using ODK.Web.Razor.Models.Components
@using ODK.Web.Razor.Models.Groups
@using ODK.Web.Razor.Models.Payments
@model IndexModel
@inject IChapterService ChapterService
@inject IChapterViewModelService ChapterViewModelService
@{
    Layout = "_HomeLayout";

    var request = Model.MemberChapterServiceRequest;
    
    // TODO: merge these calls
    var groupViewModel = await ChapterViewModelService.GetGroupSubscriptionPage(request);
    var subscriptionViewModel = await ChapterService.GetChapterMemberSubscriptionsViewModel(request);

    Model.Title = "Subscription | Profile";
}

@await Html.PartialAsync("Groups/_GroupBody", new GroupBodyViewModel
{
    Title = "",
    Content = await Html.PartialAsync("Groups/Subscription/_GroupSubscriptionContent", subscriptionViewModel),
    Group = groupViewModel
})